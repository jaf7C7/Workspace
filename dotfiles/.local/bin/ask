#!/bin/sh
#
# Quick web search.
#
# Per-search results settings:
#     https://duckduckgo.com/params
# Search syntax:
#     https://help.duckduckgo.com/duckduckgo-help-pages/results/syntax
#
# E.g. - Append '&kl=us-en' for US English region results.
#      - Prepend '\' to accept first result.

usage () {
	printf '%s: usage: ask [-s|--site <site-keyword>] <search-term>\n' "$0"
	exit 1
} >&2

main ()
{
	[ $# -gt 0 ] || usage

	case "$1" in
		-h|--help) usage ;;

		-s|--site)
			case "$2" in
				bashwiki) site='wiki.bash-hackers.org' ;;
				tldp)     site='tldp.org' ;;
				jsinfo)   site='javascript.info' ;;
				mdn)      site='developer.mozilla.org' ;;
				so)       site='stackoverflow.com' ;;
				vimhelp)  site='vimhelp.org' ;;
				vimwiki)  site='vim.fandom.com' ;;
				whatwg)   site='html.spec.whatwg.org' ;;
				wooledge) site='mywiki.wooledge.org' ;;
				*)        usage ;;
			esac
		;;
	esac
	[ -n "$site" ] && shift 2

	IFS='+' query="$*${site++site:"$site"}"
	exec "$BROWSER" "https://lite.duckduckgo.com/lite?q=${query}"
}

main "$@"

