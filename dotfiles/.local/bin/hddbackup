#!/bin/sh
#
# `hddbackup`: Backup to external hdd
#
# Depends: `mv`, `cp`, `tr`
# Environment: none

set -e

error () {
	echo "hddbackup: $*"
	exit 1
} >&2

main ()
{
	case "$1" in
		[Dd]ocuments|[Mm]usic|[Pp]ersonal|[Pp]ictures|[Ww]antlist|[Ww]orkspace)
			# Capitalise first letter if you're too lazy to hit
			# shift.
			dir="$(echo "${1%${1#?}}" \
				| tr '[:lower:]' '[:upper:]')${1#?}"
			set -- ~/"$dir"
		;;

		"")
			set -- ~/Documents ~/Music ~/Personal ~/Pictures \
				~/Projects ~/Wantlist ~/Workspace
		;;

		*)
			error "hddbackup: unknown directory: $1"
		;;
	esac

	backup_dir=/media/joss/Tub.2.0

	if ! test -d "$backup_dir"; then
		error "Could not find $backup_dir"
	fi

	for dir do
		dir="${dir#/home/joss/}"
		echo "Backing up: $dir -> $backup_dir/$dir}"
		mv "$backup_dir/$dir" "$backup_dir/$dir~"
		cp -r ~/"$dir" "$backup_dir"
	done
}

main "$@"

